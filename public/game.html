<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Monkey Tower - Juego</title>
  <link rel="stylesheet" href="css/game.css" />
</head>
<style>
  .hidden {
    display: none;
  }
</style>

<body>
    <div id="game-container">
      <!-- HUD: puntuaciÃ³n y rÃ©cords -->
    <div id="hud">
      <h2>PuntuaciÃ³n: <span id="score">0</span></h2>
      <h3>RÃ©cord: <span id="highScore">0</span></h3>
      <button id="viewRecords">ğŸ† Ver rÃ©cords</button>
    </div>

    <!-- Mensaje de rÃ©cord cercano -->
    <div id="recordWarning" class="hidden" style="position:absolute;top:120px;left:50%;transform:translateX(-50%);z-index:7;text-align:center;">
      <p style="font-size:14px;color:#ffd700;">ğŸ”¥ Â¡EstÃ¡s cerca de tu rÃ©cord! ğŸ”¥</p>
    </div>

    <!-- BotÃ³n de configuraciÃ³n (ruedita) -->
    <button id="settingsBtn" title="Opciones" style="position:absolute;top:8px;right:8px;z-index:9;">âš™ï¸</button>

    <!-- Panel de configuraciÃ³n dentro del juego -->
    <div id="inGameSettings" class="hidden" style="position:absolute;top:60px;right:24px;z-index:12;">
      <div class="panel">
        <h2>Opciones</h2>
        <div style="margin:8px 0;text-align:left;">
          <label for="igVolumeSlider">MÃºsica:</label>
          <input type="range" id="igVolumeSlider" min="0" max="1" step="0.01" value="0.5">
        </div>
        <div style="margin:8px 0;text-align:left;">
          <label for="sfxVolumeSlider">Efectos:</label>
          <input type="range" id="sfxVolumeSlider" min="0" max="1" step="0.01" value="0.5">
        </div>
        <div style="margin-top:12px;display:flex;gap:8px;flex-direction:column;">
          <button id="igMenuBtn">Volver al menÃº</button>
          <button id="igQuitBtn">Salir del juego</button>
          <button id="igCloseSettings">Cerrar</button>
        </div>
      </div>
    </div>

    <!-- Canvas del juego -->
    <canvas id="gameCanvas" class="level-background" width="460" height="720"></canvas>

    <!-- Power-up -->
    <div id="powerUp" class="hidden" style="position:absolute;z-index:8;width:40px;height:40px;background-image:url('assets/images/ui/slow-motion.png');background-size:cover;border-radius:50%;"></div>

    <!-- ViÃ±eta para efecto de ralentizaciÃ³n -->
    <div id="vignette" class="hidden" style="position:absolute;top:0;left:0;width:100%;height:100%;box-shadow:inset 0 0 100px rgba(0,0,255,0.5);z-index:9;pointer-events:none;"></div>

    <!-- Contenedor de partÃ­culas -->
    <div id="particle-container" style="position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:10;"></div>

    <!-- Mono -->
    <div id="monkey"></div>

    <!-- Jefe (Nivel 3) -->
    <div id="boss" class="hidden" style="position:absolute;z-index:5;width:80px;height:80px;background-image:url('assets/images/characters/jefe.png');background-size:contain;background-repeat:no-repeat;background-position:center;transform:translateX(-50%);">
      <!-- Contenedor para animar SOLO las piernas del jefe -->
      <div id="boss-legs" style="position:absolute;left:50%;bottom:6px;transform:translateX(-50%);width:25%;height:15%;background-image:url('assets/images/characters/piernas.png');background-repeat:no-repeat;background-size:cover;background-position:0% 0%;pointer-events:none;z-index:6;"></div>
    </div>
    
    <!-- Game Over -->
    <div id="gameOver" class="hidden">
      <div class="panel">
        <h1>ğŸ´â€â˜ ï¸ Â¡La torre colapsÃ³!</h1>
        <p>Puntaje final: <span id="finalScore"></span></p>
        <div class="buttons">
          <button id="retryBtn">Reintentar</button>
          <button id="menuBtn">Volver al menÃº</button>
        </div>
      </div>
    </div>

    <!-- Panel de rÃ©cords -->
    <div id="recordsPanel" class="hidden">
      <div class="panel">
        <h1>ğŸ† RÃ©cords locales</h1>
        <ul id="recordsList"></ul>
        <button id="closeRecords">Cerrar</button>
      </div>
    </div>
    <!-- Barra de habilidad (Nivel 2) - ahora mÃ¡s pequeÃ±a y en la esquina izquierda inferior -->
    <div id="abilityBarContainer" class="hidden" style="position:absolute;left:18px;bottom:18px;z-index:12;width:160px;height:12px;background:#333;border-radius:6px;border:2px solid #222;overflow:hidden;padding:0;">
      <div id="abilityBarFill" style="height:100%;width:0%;background:linear-gradient(90deg,#00d4ff,#0077ff);transition:width 250ms ease;"></div>
    </div>

    <!-- Escudo de la torre (vertical, cubre la torre) - solo visible en Nivel 2 -->
    <div id="towerShield" class="hidden" style="position:absolute;left:50%;transform:translateX(-50%);bottom:40px;z-index:11;width:180px;height:480px;border-radius:12px;border:6px solid rgba(0,150,255,0.18);box-shadow:0 0 34px rgba(0,150,255,0.18);pointer-events:none;display:none;align-items:center;justify-content:center;">
      <div style="position:absolute;inset:6px;border-radius:8px;width:100%;height:100%;background:linear-gradient(180deg, rgba(0,150,255,0.06), rgba(0,150,255,0.02));pointer-events:none;"></div>
    </div>
  </div>

  <!-- Matter.js -->
  <script src="https://cdn.jsdelivr.net/npm/matter-js@0.19.0/build/matter.min.js"></script>
  <!-- Scripts del juego -->
  <script src="js/score.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/music.js"></script>
  <script src="js/effects.js"></script>
  <script src="js/game.js"></script>
</body>
</html>
